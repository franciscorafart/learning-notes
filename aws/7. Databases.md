# Databases

You can store data on  EC2, EFS, EBS, Instance store but it has its limits
It is better to use a Database services, as you can stucture and query data efficiently.

- Relational databases
Relational databases allow you to query data using the SQL query language

- No SQL databases

Flexible schemas to build modern applications
Schema is the shape of the data 
Benefits: Easier to evolve data models, It allows for horizontal scaling, high performance
Example: JSON format to store data

Shared responsability
AWS
- Managed databases => Quick to provision, vertical and horizontal scaling. 
- Automated backups, restore, operations and upgrades.
- OS patching handled by AWS (different from EC2)

Note: You can run databases in EC2 but you have to manage the backups, patching, high availability, fault tolerance.

## RDS - Relational Database
- Managed DB service that uses SQL language. Can be Postgres, MySql, MariaDB, Oracle, Microsoft SQL, Aurora (Proprietary AWS)

Why use RDS instead of deploying on?
- Automatic provision
- Patching OS by AWS
- Continuous backups (Point in time restore)
- Monitoring dashboard
- Read replicas for improved read performance
- Multi AZ setup for DR (Disaster recovery)
- Maintenance window for upgrades
- Vertical and hotizontal scaling

We can't do (only thing): We can't SSH into instance.

### Solution Architecture RDS
Load balances => EC2 instances =>(read / writes) RDS

## Aurora
Proprietary Relational DB solution by AWS
Aurora supports: Postgres and MySQL
- Cloud optimized for AWS => 5x performance for MySQL and 3x performance for Postgres
- Storage grows automatically in increments of 100 MG 
- Around 20% more expensive than RDS, but it's more efficient so it can be more cost effective
- Aurora isn't part of free Tier / RDS is.

### Amazon Aurora Serverless
- Automatic database instantiation and autoscaling based on actual usage
- Postgres and MySQL are supported as Aurora serverless DB.
- No capacity planning needed.
- Least Management overhead
- Pay per second, can be more cost effective
- Use cases: Good for infrequent or unpredictable workloads

How it works: Client connects to a Proxy Fleet (managed by Aurora), and Aurora on scales accordingly on the background. These Aurora instances share the same storage Volume.

For exam: If there's a case where there's no management overhead, think of Aurora serverless.

## RDS deployment options

### Read replicas
If you need to scale the read workload you do so with `Read Replicas`   
- You can create up to 15 read replicas
- Writing is only done to the central DB

### Multi AZ
- Set up a Failover DB in another AZ in case the main availability Zone crashes (high availability)
- Failover DB is passive and only becomes accesible is there is a failure of the main database

### Multi region deployment
- You can set up Multi region read replicas
- In case of a Region issue, you can have a backup in another region
- Read DBs in different regions will get better performance if the application is running in a different region (less latency)
- There are replication cost due to data transfer between regions

# Elastic Cache
Managed Redis or Memcached databases

In-memory high-performance low-latency databases.

For exam: If they ask about the need of an `In-memory` database think of ElasticCache

What is it for? Reduces load of databases for read intensive workloads. If there's a lot of reading happening to the database and the data is the same, putting the data on ElasticCache is a good solution to take pressure off the main database.

Aws takes care of OS maintenance, patching, optimization, setup, configuration, monitoring, failure recovery, and backups

### Solution Architecture ElasticCache
Load Balancer => EC2 instance <=> ElasticCache or RDS

We can store some https response on ElasticCache / Redis to optimize the application.