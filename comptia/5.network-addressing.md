# Network addressing and internet connections

LANs have limited utility. It's only when a LAN is connecte to a WAN that it becomes really useful.
This requires modems, antennas used by the ISP that can identify each network and forward data to them.
The Forwarding function is done by router devices and the Internet Protocol (IP)

## Internet connection types and Modems

- Core of internet: High-bandwidth fiber optic links connection internet Exchange Ports (IXPs) => Mostly created by telecommunication companies and academic institutions
- ISP establish high-speed links between their networks, carrying and sending traffic to parts of the internet they don't own.
- Customers connect to internet via ISP network to the nearest `Point of Presence (PoP)`
- `Internet Connection Type` => media, hardware, and protocols that connect a local network to an ISP's PoP.
- WAN interface => point-to-point
- Ethernet connections => NICs and Switches, but connection to WAN with a type of digital Modem.

## Router
- Digital Modem connects to an external line
- Built in Switch connects devices on LAN
- External line (wall) connects to ISPs Point of Presence - PoP
- Routers implement an IP to be able to route data packages to differet devices
    - There's a LAN IP (private - typically 198.168.0.0) and a WAN ip (public - any IP number)

## Digital Subscriber Line Modems

### PSTN
- Many internet connection types use Public Switched Telephone Network
- Fiber optic core
- Twisted Copper pair at the edges -> Plain Old Telephone System (POTS)

#### Digital Subscriber Line (DSL)
Usage of higer frequencies on this copper lines as communication channels
    - Assymetrical DSL (ADSL)
        - Fast download but slow upload
        - ADSL 2 => Down 24MBps up 1.25-2.5 MBPs
    - Symmetic
        - Same upload and download speeds
        - More used in businesses

#### DSL modem
- Separate or integrated to th SOHO router
- Has a RJ11 connector for the telephone cabling
- RJ45 connects model to router (in standalone DSL modem)

## Cable Modems
- Coaxial cable => 
-  Cable based on the Data Over Cable Service Interface Specification (DOCSIS) => Download up to 38MBps and uplinks up to 27MBps
- DOCSIS 3 => Greater bandwidth
- COAX connects the Modem with a Cable Modem Termination System (CMTS) in the street that fowards data via de fiber backbone.

## Fiber to the curve and Fiber to the premises
Bandwidth in the last mile is the greates obstacle for data to travel as fast as in a LAN, as it usually has low-grade copper wire.
Fiber to the X (FTTx) are projects trying to fix this

### Fiber to the Curb and VDSL

### Fiber to the premises (FTTP)
- Fiber cable all the way to customers building
- Passive Optical Network (PON) => single fiber cable run from Optical Line Terminal (OLT) to a splitter
- A splitter routes traffic to the customer on a Optical Network Terminal (ONT).
- ONT connects to the customer's router with an RJ45 connector

## Fixed Wireless Nternet Access
For when running cable is not possible or too costly.

### Geostationary Orbital Satellite Intenet access
- Satellite based micro-wave radio system: 2-6MBps up, 30 MBps down.
- Delay due to large distance of signal => Not great for real time applications
- RTT: Round Trip Time
- It's installed with a Satellite dish (VSAT) on the premise pointing towards the stationary satellite in the equator
- Antenna connected to a Digital Video Broadcast Satellite Modem (DVB-S)

#### Low Earth Orbital (LEO) Satellite Internet access
- Lower orbit satellites => Better bandwidth and lower latency
- More satellites in array => Dish requires an automatic motor to align with satellites
- Satellite needs clear view of all the sky

#### Wireless Internet Service Provide (WISP)
- Ground-based long range fixed access wieles (antennas)
- Line of sight between Antenna and customer receiver must remain unobstructed
- If unlicensed spectrum => Interference

All wireless communications can be affected my weather conditions like snow, rain, and high winds

## Celular radio Internet connections
Fixed wireless => large dish antenna
2.4 and 5GHz => Short range

Cellular radio internet allow for mobile devices to connect.

### Generations
#### 3G
- Cellular radio connects to closer base station
- Cell: Area serverd by a base station (up to 5 miles / 8km)
- Operates between 850 and 1800 MHz band
- Low frequency bands don't need much so much power to communicate over long distances

2 formats:
 - GSM (Global System for Mobile Communications): Applies to phones with removable Subscriber Identity Module (SIM)
 - Core Division Multiple Access (CDMA): Directly managed by the provider, no SIM card.

Codes representing 3G services:
 3G => 3MBps
    - Universal Mobile Telecommunications (UMTS) on a GSM handset 
    - Evolution Data Optimized (EV-DO) on CDMA networks

- H/H+ => High speed Packet Access (HSPA) Up to 42MBps, but likely much lower.

#### 4G
Long-Term Evolution (LTE). 
- Supported by both GDM and CDMA network providers
- Needs a SIM card

#### 5G
- Use of different spectrum bands (sub-6GHz) to medium/high (20-60 GHz)
- High frequency bands require proximity and can't travel through walls and windows
- Rolling out 5G is complex => Many smaller antennas instead of one bigger one. => Massive Multiple Inpute Multiple Output (MIMO)

** 4G and 5G can be used for fixed-access wireless broadband for homes and businesses. **

## Routers

Intermediate system that can distingish between the LAN and WAN and interact with them.
- Implemented with the TCP/IP protocol
- Switch and APs fowards packages using MAC addresses, Router fowards packages using IP addresses.
- Digital Modems, ONT, and cellular radio transmiter create a point-to-point link.
- To connect a LAN to a network you need a router
- IP address contains the address of a Network and a single host within that Network

LAN router
- Divides single physical network in multiple logical sub-networks
- Each logical sub-network is a seaparate broadcast domain
- Usually only Ethernet interfaces

WAN / border router
- Forwards traffic to and from the internet over private WAN link
- Ethernet interface for local network and Digital Modem interface for the WAN

## Firewalls

Determines what devices are allowed to connect to a network and what kind of traffic they can accept
- Firewall implements a rule set called a network Access Control List (ACL)
- ACL determines wether to allow or block traffic on different ports
- Routers implement some type of firewall
- It can be implemented as a standalone appliance that makes deeper analysis of application protocol => Unified Threat Management (UTM)

# Basic TCP/IP concepts
Technician must be able to configure TCP/IP on PCs and SoHO routers

TCP/IP is a protocol suite, that acts on different layers of network communications. This means that TCP/IP is a combination of different protocols that allow data flow in different layers.

## 4 layers TCP/IP
1. Application -> https, dns, smb, IMSP, PoP3...
    - Used to operate services, like web and email, beyond addressing costs and transporting data
    - Each application uses TCP and UDP port

2. Transport -> TCP / UDP
How each host manages multiple connections at the same time.
Transmission Control Protocol (TCP): 
    - Indentifies missing or out of order packages => mitigates unreliability of IP
    - Used by most application protocols to ensure data integrity and avoid errors
User Datagram Protocol (UDP):
    - Unreliable connectionless fowarding.
    - Faster
    - Used in time-sentitive applications (speech video) where missing or out of order packages are acceptable
    - Glitch instead of crashing

3. Internet -> IP
- Deals with addressing
- Packet addressing and routing in a network of networks
- Devices are end system hosy
- Data from network to another must be forwarded by an intermediary system (Router)
- ARP (Address Resolution Protocol) => Allows host to query which MAC address is associated to an IP address
- Best effort delivery => Unreliable and connectionless. Packages can be lost or delivered out of sequence.

4. Link / Network interface -> Ethernet / Wifi
- Puts frames into physical network
- Local level with nodes identified by MAC addresses

### Protocol Data Units (Extra)
User data goes down this stack from say a website or email all the way to the network card of the receiving host

1. Application layer => Data
2. Transport Layer => Sewgment (Data + Transport Header)
3. Network Layer / Internet => Packet (Network Header + Transport Header + Data)
4. Link => Frame (Frame + Network Header + Transport Header + Data + Frame) . Frames are different for ethernet and wifi
    4.2 Phsysical => Bits

## IPV4 addressing
- IP provides network and hosting `addressing` and `packet forwarding` between networks
- IP adds a header to whatever package is being transported in the payload
- 32 bit number divided in 4 8 bit ones (octets)
- Can be represented by 4 decimal 8-bit numbers (0-255) separated by a period Ex. 192.168.0.1

## Network Prefixes
Ex. 192.168.0.1/24
- IP addres = Network Address + Host Address / Network Id + Host Id => 192.168.0 (Network Id) + .1 (Host Id)
- Network Prefix: 
    - `11111111 11111111 11111111 00000000` 32 bit numbers with continuous bits set to `1`
    - Slash notations: `/24`
    - Subnet Mask notation `255.255.255.0`
    It represents the number of bits that separate the Network Id from the Host Id in the 32-bit representation of the IP address. If there's a one, the binary digit is part of the network ID.

Subnet name is becase IP network can be divided into multiple logical subnetworks (subnets) with this method.

- Subnet masks is typically used in host configuration dialogs:
    - 192.168.0.0/24 -> Refers to an IP network address
    - 192.168.0.0/255.255.255.0 -> Refers to host address on that IP network

## IPV4 Forwarding
### Same network communication
- 192.168.0.100/24 sends package to 192.168.0.200/24
    - Protocol compares src and dest addresses and determines it's in the same IP Network or subnet (192.168.0.0)
    - On Ethernet, the host will use Address REsolution Protocol (ARP) to identify the MAC address of the destination IP address
### Different networks
- 192.168.0.100/24 sends package to 192.168.1.100/24
    - Host identifies dest is on a different IP network
    - Hosts have a `default gateway` which is the address of the router to which the host can send packages to other networks
    - Default gateway must be in the same IP network as the host => `$ ip route ` or `$ route -n` commands to see default gateway

## Public and Private addressing
Every host requires a IS-provided IP address to connect to the internet. There's a limited amount of IPV4 addresses, and there's mechanism to work around this limitations.

### Private address ranges
There are 3 reserved ranges for private addresses. A host in these ranges cannot communicate with the internet, only LAN:
10.0.0.0 to 10.255.255.255
172.16.0.0 to 172.31.255.255
192.168.0.0 to 192.168.255.255

Learn these to recognize them: 10 | 172.16 | 192.168

### Address classes and default Subnet Masks

A: `255.0.0.0` or `/8` or `11111111 00000000 00000000 00000000` 
B: `255.255.0.0` or `/16` or `11111111 11111111 00000000 00000000`
C: `255.255.255.0` or `/24` or `11111111 11111111 11111111 00000000`

### Internet Accessing using Private Addressing
A host with a private ip address cannot communicate with the internet, so it needs a mechanism to forward packages.

1. Router: Through a router configured with a single or block of valid IP addresses: Router uses Network Address Tranlation (NAT) to turn private address into public one.
2. Proxy server: Through Proxy server that fulfills requests on behalf of clients

## IPV4 Host Address configuration
A host must be configured with:
1. Static IPV4 address
2. Subnet (As decimal notation or prefix length in bits (ex. 24))
3. Gateway -> Router IP in LAN network.
    Failure to specify it can limit the hosts communication to the local network only
4. DNS / Alternative DNS
    A DNS server IPV4 address. Typically primary DNS address is the same as the gateway address. Router is configured to send DNS queries to a secure resolver. An additional alternative DNS address can be added (ex. 8.8.8.8 Google - 1.1.1.1 Cloudflare, or ISP)
    - Private DNS can resolve local network domains and also cache existing registries.
    - If they can find the address they use a DNS forwarding to find the associated address 
    - Primary DNS usually on DNS server or Router. Hosts can also have a specific public DNS, but it's not DNS forwarding.

## Static vs Dynamic host address configuration
