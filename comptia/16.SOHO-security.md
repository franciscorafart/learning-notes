# Configuring SOHO security

# Attacks, Threats, Vulnerabilities

## Information Security

1. Information Security - Secure information triad CIA
- Confidentiality
- Integrity
- Availability

2. Cybersecurity => Controls to protect attacks on computer storage and processing systems

Hardening system: Making it more secure, adding policies and controls.

3 components of assestment of networks:
1. Vulnerabilities => weaknes that can be intentionally or accidentally triggers
2. Threats => Potential for an actor to exploit a vulnerability, intentionally or accidentally.
   ` Theat actor`: Who poses the threat
3. Risks: Likelihood and impact (consequence) of a vulnerability being exploted by a Threat Actor.

Important:
Vulnerability + Threat = Risk (Impact * likelihood)

## Vulnerabilities
Causes: Misconfigurations software and hardware, delays on patching, untested software/firmaware, poorly designed architecture, inadequate physical security, bad passwords, unchecked user input, etc.

### Non-Compliant Systems
- Configuration baseline: Recommendations for deploying computer in hardened configuration
- Baselines are different for different systems, OS, and clients
- Purpose of configuration baseline => Reduce attack surface
- Non-compliant System: A system that drifted from its baseline configuration

### Unprotected System
- Example baseline recommendations: Antivirus scanners, firewalls, intrusion detection systems.
- Unprotected system: System where at least one of this elements is missing or misconfigured => Increases attack surface

### Software and Zero-day vulnerabilities
- Software vulnerrability => flaw in design or code that allows security circumvention or app crashing
- Exploits: Most serious vulnerabilities. Allows attacker to execute code on host, that can install mallware
- Zero-day: Vulnerability that is exploted before the developer knows about it and can release a patch

### Unpatched and EOL OSs
- Zero-day very destructive but not common
- Greater threat is unpatched legacy systems
- Not only PCs, but any device running on a network can be hacked

### BYOD Vulnerability
- In BYOD it's hard for security team to define secure baseline configurations for multiple devices
- BYOD increases Attack Surface

## Social Engineering

- Social Engineering: Hacking the human => Persuading or intimidating individual to reveal critical information

Common formes of Social Engineering:
1. Impersonation: By pretexting (direct communication), telling a lie or half-truth, a Threat Actor can get trust from an employee and give information

2. Dumpster Diving:
- Public information of an employee or organization can make an impersonation attempt more credible.
- Dumpster Diving: Getting information from documents company has thrown away or discarded removable media

3. Shoulder surfing
- Learning a password or PIN by watching the user type it, or through binocuars, CCTV

4. Tailgating and Piggybacking

- Tailgating: Enter secure area without authorization by following person closely
- Piggybacking: Entering a secure area with an employees permission (I forgot my key)

## Phishing and Evil Twins
- Phishing: Making spoofed electronic communication seem authentic to victim. Asking to install a malware, giving remote access, spoof websites to capture login credentials.

### Phishing variants
- Spear phishing: When atacker has information that makes target more prone to fall.
- Whaling: Attack directed at upper levels of management (CEOs or big fish) who are usually reluctant to security procedures.
- Vishing: Phishing through Voice (telephone, VoIP)

### Evil Twin atack
- Use of rogue wireless access point to try harvesting credentials
- Similar network nae (SSID) to trusted one
- Redirect users to spoofed websites

## Threat types
- Static threats were common in the past: Viruses that can be easily identified with automated software
- Currently attackers can circumvent signature-based scanning => Threat complex and multi factor

### External vs Internal threats
- external threat: actor with no account or authorized access => Has to infiltrate using malware or social engineering
- Insider threat: Actor with system permissions (employee, business partner, contractor), malicious or non-malicious.

### Footprinting threats
- Information gathering were attacker tries to identify networks and security system configuration
- Public info, scan ports and websites, social engineering to discover vulnerabilities

### Sppofing threats
- Atack were threat actor can mask as a trusted user or PC.
- Ex. Cloning MAC or IP addresses, false digital certificate, email message that imitates original
- Spoofing also can be done to obtain logical or software authentication token
- Replay attack: Capturing token and presenting it to access platform

### On-path attacks (Man-in-the-middle attack)
- Spoofing were traffic is covertly intercepted between two hosts/networks => Read and modify packages

### Denial of Service (DoS)
- Making service unavailable for regular users
- Bombarding services with spoofed requests
- Physical DoS => Cutting cable or turning computer off
- Often used to mask different kind of attack => Distract security team to go after another goal

### Distributed denial of Service (DDoS)
- DoS attack launched from multiple compromised systems or `botnet`
- To establish botnet threat actor must first compromise +1 machine to use Command and Control (C&C)
- C&C machine is used to compromise many other devices by installing bots automatically
- Bot establishes persisten remote-control channel with C&C host => Attack using all devices in the botnet

## Password attacks
- Many attacks occur because threat actor gets credentials to access network
- When actors gain access they attempt to escalate privileges
- A plaintext password can be obtained with password file or sniffing unencrypted traffic.
- Password usually transmited with a cryptographic hash of string entered by user
- Hacker can get file with password hashes in local system: `%SystemRoot%\System32\config\SAM`, `%SystemRoot%\NTDS\NTDS.DIT` and `/etc/shadow`

- PAssword cracking software can be used to identify password from the cryptographic hash
1. Dictionary
Hash is compared to hashes of common passwords or information related to the user

2. Brute force
A password can be brute forced in minutes if not a good one

## Cross Site scripting attacks

- Most web applications rely on user input
- Fail to validate input: common web app vulnerability
- Threat actor could be able to send a script through an input field => Input validation vulnerability

- XSS - Cross Site scripting => Browser trusts scripts that come from site user is visiting.
Steps:
1. Attacker identifies Input vulnerability on site
2. Attacker crafts a URL to perform code injection
3. User opens link trusted site returns page that contains malicious code that will be executed by Browser
4. Code steals users cookies, intercepts data put into a form, or installs malware.

- XSS attack is non-persistent => At no point data in server changed

## SQL injection attack
 - Adding SQL code to an unsanitized input field
 - Attacker could extract, create, or delete information.
 Ex: User inputs name as "Bob"
 `SELECT * from tbl_user WHERE username = 'Bob'`

 But putting `' or 1=1--` on the input:

SELECT * from tbl_user WHERE username = '' or 1=1--#

- 1-1 always true and `--#` turns rest of statement into comment.
- This would dump a list of all users

## Hashing and Encryption concepts
Three types of cryptographic technology
1. Cryptographic hashes
- Turns any input into a fixed-length string output.
- One-way input => Can't recover original data from hash
- Used for secure storage of data were original content doesn't have to be recovered (passwords)
- SHA and MD5 are popular algorithms. MD5 gradually being phased out.

2. Symmetric encryption
- Single key to encrypt and decrypt data
- If key is stolen security is breached => Main problem
- Advantage: Speed . AES can encrypt multiple streams of data efficiently

3. Assymetric encryption
- Key pair, mathematically linked public and private key
- What one key encrypts, the other decrypts
- Private key is kept secret (user or PC)
- Public key is open for anyone to use => Private key cannot be derived from public key
- Drawback: message can't be larger than the key size

## Digital Signatures and Key exchange

- Different uses of Encryption and hashes
- For large file assymetric encryption splits file into many pieces
-A combination of symmetric and assymetric encryption and hashes is udes to develop some products

### Digital signatures
- Proves a message or digital certificate has not been spoofed
- Sender computes a cryptographic hash, encrypts it with his private key, and attaches the result as a digital signature
- Receiver decrypts with public key to obtain senders hash. Then computes its own hash and compares it

### Key exchange
- Allows two hosts to share same symmetric encryption key without any other host knowing what it is
- Symmetric cypher faster => Protect data exchange on a session
- Assymetric encryption used to share the symmetric key, as it works better on smaller texts
- Sender uses public key to encrypt symmetric key
- Receiver uses private key to retreive symmetric key
- Receiver uses symmetric key to decrypt message sent by the sender
- Symmetric key is called `session key` and `ephemeral key` if it is changed often.

