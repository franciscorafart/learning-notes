
## OS installation and upgrades

OS Installation process puts files in installation media into a drive's partition.

Types of installation:

### Clean install or in-place upgrade
`Attended installation`: Prompts to set up OS configurations:
- Clean Install:Install OS on new PC or overwriting existing OS by repartitioning or formatting disk. Everything wiped.
    - More reliable
- In-place upgrade: Running setup from existing version of OS => Settings, third-party apps are kept.
    - Mostly for home users

### Upgrade considerations
1. Hardware compatibility: Sufficient resources to run the new OS.
2. Application and driver support/backwards compatibility
 - Incompatible software or hardware should be uninstalled before attempting in-place upgrade. Incompatible apps and drivers would have to be replaced.
 - Microsoft maintains a `LPL` (Logo'd Product List) catalog with tested devices and drivers (previously HCL - Hardware Compatibility List)
    - Automated Upgrade Advisor can check if Applications and Hardware will be compatible with new Windows version

3. Backup files and user preferences
- Security backup for in-place upgrade or torestore data and settings after clean install

4. Obtain thrid-party drivers
OS setup might not have drivers for certain hardware devices -> Usually only an issue for RAID controllers. If controller driver not available setup program won't be able to use RAID controller.
- Save drivers for hardware on USB stick for easy installation after upgrade. Windows setup media has drivers, but are often not updated.

### Feature Updates
`Feature updates` paradigm to introduce changes in Windows 10 & 11: `product lifecycle` => Delivered via Windows update.
- Better to treat a Feature Update as an in-place upgrade, though rarely it produces hardware problems => Check for hardware and Software compatibility concerns

## Unattended Installations
Attended installations are slow, and too much for large deployments
There are several ways of doing unattended installations of the OS:

- Answer file
    - Uses a script or configuration file to input choices and settings => In Windows it's called the `answer file`
    - Windows System Image Manager used to configure `answer file`
- Image deployment
    - Image is a copy of an existing installation of the OS stored on a file
    - Image can container settings, applications, service packs, etc => Can be stored in USB or DVD
    - Consistent set of software and configuration options

    - Before imaging we need `SysPrep` utiliy - Windows generates a new SID (Security Identifier) every time we deploy that image
    - We also need an Answer File to automate the process => Done on Windows System Image Manager utility

**TODO: Run commands from video on Windows system**

## Boot Devices
Boot device => how setup program, answer file, and OS file or System Image is loaded onto traget PC. Has to bee set up to the higherst priority on computer's firmware.

### Optical media
Historicaly Attended installations are done from a CD or DVD.

### USB, External Drives, and Flash drives
- Disc not common these days
- Disc based installations quickly become out of date => post-installation tasks can take longer than original installation
- We can build a more current image and put it in a USB drive
- `Media Creation Tool` is utility to create bootable USB drives or an ISO image for a CD.

### Network Boot
- Connecting to shared folder containing installation files (slipstreamed or image deployment)
- PCs come with PXE - Preboot Execution Environement => compliant formware and network adapter that supports network boot.
- Client uses DHCP to locate suitable configured server with installation files

### Internet-based boot
- Local DHCP must be condifured to supply DNS name of installation server
- Most setup installers need to connect to the internet to download packages

### Internal Hard drive - partition
- Once OS installed, set internal hard drive as highest priority boot device => System doesn't boot install again
- In addition, an internal partition can be used as recovery partition

## Disk Configuration
- Disk requires partitioning and formatting before it can be used
- Partition is logically separate storage area in disk => At least one partition before formatting to create a file system

Two types of Partition information:
1. MBR - Master Boot Record
- Stores partition table on first 512-byte sector
- Up to 4 primary partitions, with one marked as active (bootable) => 4 differen drives on physical disk and multiple OSs
- Each drive can be formatted with a different file system

- Start of each primary partition contains `boot sector` or PBR Partition Boot Record
- Record that point to the OS boot loader
- In Windows referred to System Partition or System Reserved
- Boot partition => drive containing Windows OS files => Doesn't have to be the same as the syste drive
- ***When using MBR, firmware must be set to use legacy BIOS boot method.*** => Can't be UEFI, disk won't be recognized as boot device

2. GPT-Style Partitioning
- Global UID Partition table
- Addresses limitations of MBR
- Support for +4 primary partitions: Windows supports 128 with GPT
- Supports larger partitions +2TB and backup copy of partition entrues
- Protective MBR for compatibility with devices that don't recognize GPT    
- *** Firmware must be set to UEFI boot method *** => Can't be BIOS, disk won't be recognized as boot device

### Drive Format
- OS must be installed in a drive format compatible with File system
    - Windows: NTFS
    - MAC: APFS
    - Linux: ext3 or ext4
- Partition and formatting choces guided through instalation

## Repair Installation
When PC can't boot or slow performance without a single cause.

### Recovery Partition
- Recovery partition is tool (OEM recovery media) able to reset system to factory configuration
- Created on internal fixed drive
- If main installation doesn't boot, we can select recovery partition to boot system on the firmware => Simple Wizard process replaces damaged installation
- OEM media doesn't recover user data, settings or applications => Backup before
- Disadvantages:
    - Only works with if original hard disk is still installed
    - Doesn't onclude service patches or packs applied between shipping date and recovery date
    - Recovery Image uses a lot of space

### Reset Windows
- Refresh and reset copies to try repairing the installation
- Recopies System files and reverts system settings => Can preseve user data files and Windows Store apps. Desktop applications removed.
- Full reset wil delete OS, apps, data => Ready for OS to be reinstalled

# Install and Configure applications