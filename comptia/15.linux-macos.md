# Linux

- Desktop and server OS => High reliability and security

## Shells, Terminals, and Consoles
- Kernel: Software with core set of OS functions => managing hardware, communication between software and hardware
- Linux distro: Kernel + package manager with customizable shells, utilities, and applications.
    - They have community-supported or commercial licenses.
    
### Shells and Terminals
- Software to operate the OS: Bash, Zsh, ksh (Korn shell)
    - Distinguished by features like command history, tab completion, syntax highlight, etc

- Some linux distros are deployed with no desktop envioronment
    - Boot process launches Terminal interface for interacting with shell command interpreter 
    - Shell and Terminal connected via teletyp device (tty)
    stdin(0): Takes keyboard input and writes it to the tty device
    stout(1): reads data generated by the shell and displays it to the terminal
    stderr(2): Carries error information

- Interactive: Typing command on the shell
- Non-interactive: Shell reads commands from a file script

### Desktop Environments

- Client distros come with desktop environment
- Graphical env dirven by open-source version of X Window Display called Xorg or X
- Variuos desktop programs can be launched from X: Gnome, KDE, Cinnamon, Ffce
- Supports terminal emulator on a window on the desktop => Connects to the Shell via presudoterminal interface (pty/pts)

### Console Switching
- X server occupies one of several tty consoles (tty7)
- CTRL+ALT+Fx to switch between consoles

## Command Interface
Command syntax:
`command --options/-o arguments`

pipe `|` => Redirect result of a command to another command
`;` => More than one command in a line.

### Case sensitivity
- commands, parameters, and file directories are case-sentitive in Linux

### Help system
`--help` option to find help about a command
`man` => Command manual

### File editors
- Nano: Basic text editor, prefered by people coming from Windows environment
- vi or vim: Use of insert and command modes. `i` to insert text, `ESC` to exit to command mode
    - `o` inserts text on a new line
    - `:w` Save file
    - `:wq` Save and quit
    - `!q`Quit without saving

## Navigation commands
- Everything in Linux represented as a file in a unified File system Ex. First disk `/dev/sda`, second disk `/dev/sdb`
- On boot, system Kernel and virtual file system loaded to RAM. Unified file system identifies location of persistent boot partition and loads file system stored on the disk.
- Unified file system starts at the root `/`
- File System Hierarchy Standard (FHS) => What folders under root and which files where
    - `/home` => Files for users
    - `/etc` => Configuration files

`pwd` => Print working directory
`cd` => Change directory
`ls` => list content of directory (Like `dir` in Windows)
    `-a` => Display all files
`cat` => Print file content
    `-n` => Adds line numbers to the output
    `cat > file` => Overwrite any data in the destination file
    `cat >> file` => Append the cat data to the destination file

## Search commands

### find
- Used to search files
- Syntax `find path expression` path is starting path, expression is data to match
- Options `-name` `-size` `-user` `-type`
Ex. `find ./ -type d -name src` => Find all directories with name src in ./ directory

### grep command
- grep: Globally search regular expressions and print
- Search and filter contents of files
- displays the lines that contain search string
- string canbe a string literal or regex

Ex. `grep -i "uid=1003" /var/log/messages`
- You can pipe `|` the result of grep

### Metacharacters and escaping
- Escaping characters necessary when writing expressions
Three ways to escape strings:
- `\` escapes next character only
- `' '` single quotes perform strong escaping, everything inside is treated as literal characters
    `'$(pwd) * example one'` would be `'$(pwd) * example one'`
- `" "` double quotes is weak escaping. Escapes metacharacters but allows command substitution. Ex: `"$(pwd) * example one"` would be `<current_directory> * example one`

## File management commands
`cp` => Copy files
`mv` => Move and rename files
`rm` => Delete files
    `-r` recursive option to delete directories
`df` => View device's free space
`du` => displays disk usage

## User Account Management
- Root user / superuser can do any task in a Linux system
- Good practice to use regular user and elevate permissions when needed

### su
- switch user `su username`
- switch to superuser account if username ommited
- `su -` changes to the root user and launches new shell

### sudo
- superuser do => Any account listed in /etc/sudoers to run command with superuser privilege
- Advantage: Root password doesn't have to be shared between administrators

### User Management Commands
`/etc/passwd` => User settings storage
`/etc/groups` => group settings storage
`/etc/shadow` => encrypted passwords

`useradd`, `usermod`, `userdel` => Add, modify, and delete user information
`passwd` => Change user password

### Group Management Commands
- Groups are useful for assigning users for permission purposes
`groupadd`, `groupmod`, `groupdel` => Add, modify, and delete group
- User can belong to multiple groups but can have only one group ID at a time
    - Effective group ID listed in `/etc/passwd` and can be changed using `newgrp` command

## File Permission Commands
Three rights for access in Linux:
Read (r)
Write (w): Modify or delete
Execute (x): Run executables or scripts

For each object permissions are set for the 1. owner - 2. group - and 3. other users
Permissions allower (r w x) or denied `-`

Examples symbolic notation permissions:
`ls -l`

`drwxr-xr-x 2 bobby admins Desktop` 
    `d`: First character is file type, `d` is directory(Desktop)
    `rwx`: Access of owner bobby, read, write, execute
    `r-x`: admins group only read and execute
    `r-x`: Rest of users only read and execute

`-rwxr-xr-- 1 bobby admins scan.sh`
    `-`: First character file type, `-` regular file (scan.sh)
    `rwx`: user bobby has read, write, execute
    `r-x`: admins group has read and execute
    `r--`: Rest of world just read permissions

### Numeric expression of permission (octal)
Permissions can be expressed by binary numbers
r: 4
w: 2
x: 1

As a consequence, the permission of a file can be expressed as a number:
Ex. 0754

First value 0  can be ommitted
`7`: 4+2+1 or `rwx` for user
`5`: 4+1 or `r-x` for group
`4`: 4 or `r--` for rest of world

Other combination is `6`: `rw-`

### chmod command

Command to change permissions using symbolic or octal notation
- Only owner can change permissions

### chown command
- Command to change file/directory owner
- Reserved to superuser or sudoer
- File owner can change group with `chgrp`

## Package Management Commands
Distro types have different package managers for software

APT - Advanced Package Manager => Used by Debian distros and .deb file format
YUM - Yellowdog Updater => RedHat distros with .rpm file format

### Distros and repositories

- distros have pre-compiled packages approved by sponsor or vendor
- Copies of packages available posted on software repository
- package manager needs to be configured with web address of software repository
- Integrity of packages tested with cryptographic hash of the compiled package. 
    - Hash value and function published on package vendor's site
    - Package manager validates the signature before installing the software

### apt-get
- command interface for apt
`apt-get update` => Refresh local db with info of packages available in repository
`apt-get upgrade` => Update packages with latest versions
`apt-get install <package>` => Install new package

Newer version is `apt`

### yum command
`yum check-update` => refresh local db
`yum update` => Updatepackages with latest versions
`yum install <package>` => Install package

### Antivirus
- Many distros => Harder to write virus that affects different Linux distros
- Different shells, simpler security system, software package managers => Harder to write viruses
- Not riskless: Trojans and security vulnerabilities in software distributed by repositories
- ClamAV: Clam Anti Virus and Snort Intrution Prevention System (IPS) to block malware
    - Owner by CISCO but open-source products under GPL license
- anti-alware also useful to prevent Linux infecting Windows systems

## Process Monitoring Commands
- Every process has a unique ID  - PID so users and system can identfy it
- PID 1 allocated to the initial Deamon, parent of all processes in the system

### ps command
- invoke process table => summarizes current running processes in the system
- Includes process id, controling terminal (tty), accumulated CPU time, and command that started the process.

### top command
- list processes and process management tool
- prioritize, sort, or terminate processes
- dynamic process status that refect real-time changes

Common functions:
`Enter` Refresh status of processes
`SHIFT+N` Sort by decreasing PID number
`M` Sort by memory usage
`P` Sort by CPU usage
`u` display processes by users specified at the prompt
`q` Exit process list

## Network Management Commands
- Ethernet interfaces usually eth0, eth1, eth2
- Distinguish between running and persistent configuration
    - Persistent Configuration: Applied after reboot or after network adapter reinitialized
        -   historically by editing `/etc/network/interfaces` and bringinginterfaces up and down with `ifup` and `ifdown` scripts
        - Distros use now NetworkManager package (GUI or nmcli)
        
### ip command
- ifcongig: legacy net-tools. Can still be used to report on network interface configuration
- net-tools replaced by iproute2 package with ip command
- ip command: managing routes and local interface configuration
- `ip addr` replicates `ifconfig`
- `ip link` status of interfaces

`ip link set eth0 up|down` enable or disable interface
`ip addr add/delete` modify IP address configuration

Changes are not persisten, and apply only to running configuration

### dig command
- To gather info and test name resolution
- Outputs ip address mapped to the domain name
- Syntax: `dig domainname`

### Samba
- SMB compatible file sharing protocol
- To integrate Linux and Windows systems
- If added to Linux workstations, it can use Windows file and sharing protocol to access resources on a windos host
- If added to Linux server, Samba uses SMB to share directories with Windows clients.

## Backup and scheduling commands
- Linux has no official backup tool
- cron job or script can be used

### cron
- every user can schedule programs or tasks in their personal cron table
- Every minute cron checks the schedule and executes programs for that period

`crontab -l` list cron jobs
`crontab -r <cronjob>` remove corn job from schedule
`crobtan -e` enter the crontab editor

Syntax:
`mm hh dd MM weekday command`
mm: minutes past the hour
hh: hour 0-23
dd: day of the month 0-31
MM: Month 1-12 or jan,feb, mar
weekday: 1-7
command: command or script to run

* wildcard
`15 02 * * 5 /usr/bin/user.sh`
Run user.sh script every friday (5) at 2:15 am


# MacOS

Typical in art, music, graphic design, and education because it has apps geared towards those audiences.

## Interface features

- Menu bar at the top
- Dock: Quick click access to applications
- Spotlight search: Command+Space to find anything on the OS
- Terminal: Command line that runs Z shell (zsh) or bash
- Mission control and multiple desktops
    - Mission control allows users to set multiple desktops, different sets of apps, backgrounds
    - Drag apps to the top to add it to new desktop

## System Preferences
- Equivalent of Windows settings app
Differences
- Apple Keyboards: Different keys Command, option and Ctrl. Option usually mapped to ALT
- Magic mouse, trackpad and gestures
    - Gesture enabled magic mouse and magic trackpad peripherals

- Displays:  Configure scale, brightness, night shift.
- Accessibility prefpane: Assisted vision, sound options

## Security and User Management
- Administrator account and Guest account can be creted when MacOS is installed

### Apple ID
- Each local account associated to an apple ID
- To purchase in the app store, iCloud access, and other functions

### Security & Privacy
- Options for telemetry/analytics
- permissions for apps to use services like location, camera, data stores, contacts, calendar

### Internet accounts and keychain
- Internet Account to associate other email and cloud accounts with login
- keychain helps to manage passwrods for accounts. Also available in iCloud Keychain to make the available accross apple devices.

### File Valut
- Disk encryption product
- Protects from disk removed from computer and accessed in another OS
- Each user account must be configured with a password
- You should configure a recovery method when disk encrypted for the first time
- Recovery key can be stored on iCloud or recorded locally (not on encrypted drive)

## Finder and iCloud
Finder => File Explorer equivalent
iCloud => Online storage solution
    - 5G by default
    - shared accross iCloud components and devices

## App installation and management
Two distribution methods:
### App store
Distributes apps and OS updates

### App downloads
- Download from vendor's site
- By default Mac only lets downloads from the App store: `System Preferences -> Security & Privacy`

Two MacOS package installer formats:
- DMG: Disk image. Simple installs that have to be dragged into application's folder
- PKG: When app setups needs to perform additional actions, like running service or write files to multiple folders

- When app installed it appears with an .APP extension in applications folder

### Uninstallation
- Drag app to trash (simple)

### Antivirus
- Not a lot of conventional viruses or worms
- But, Mac vulnerable to fake security alerts and trojans
- Also, Mac hosts can pass viruses to Windows hosts via email or file transfer

Steps to protect an Mac:
- Download trusted apps (App store)
- Download from trusted sources 
- Use antivirus: Free AV available for Mac (Avira, Avast, Sophos) to detect malware directed at Mac and Windows
- If a bootable Windows partition on MAc, treat it as a standalone windows machine

### Corporate restrictions
- MacOS installation must be enrolled in mobile devive/endpoint management suite
- Corporate apps can be pushed to devices via Business Manager portal

## OS and Updates
- MacOS looks daily for updates and patches
- You can update indiviual apps or Update All in `Software Update`
- In `App Store -> Preferences` you can set up automatic updates
- Apps installed from thrid-party developers will automatically check for updates

## Network and Device settings

### Network
- Configure it via Status menu on right hand side or `System Preferences`
- Use `Advanced` to configure IP properties and proxy settings

### Printers and scanners
Use prefpane to add and manage printers

### Disk Utility
- Verify or repair disk or file system
- Erase disk
- No need for regular defragmentation

### Optical drives and Remote Disc
- No optical drives since 2016
- Remote Disc: Lets users access DVD driveon another Mac or Windows computer
    - `System Preferences -> Sharing` and check CD or DVD sharing.
    - Access the drive by selecting Remote Disc on Finder

## Time Machine backup
- Data backup n external drive or partition using APFS
- Hourly backups for last 24 hours, daily backus for a month, weekly backups for the previous month
- When drive becomes full, Time Machine removes older backups to make space
- To restore files, slide  timeline to time/date you want to restore the syste to from the available options.

## Troubleshoot crashes and Boot issues

### App crashes
- If app gets stuck you can apply Force Quit from apple menu or COMAND+OPTION+ESC

### Recovery Menu
Utilities to restore Mac from Time Machine backup, reinstall MacOS from system image, reformat or repair system disk

- COMMAND+R : Access recovery menu
- When booting a Mac, if start up drive not available it will attempt to boot from a web-based drive