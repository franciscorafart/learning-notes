# Managing Windows

Settings and Control Panel for configuration of single computer. Command line is necessary for more advanced and multiple PC configuration in enterprise environments.

## MMC (Microsoft Management Consoles)
- Standard interface for advanced configuration Windows desktops and servers (schedule tasks, security, disk subsystem)
- Registry Editor when a configuration not present on GUI tools

## Device Manager (devmgmt.msc)
Page to view and edit properties of hardware (change config, update drivers, remove)

### Updating and trubleshooting devices
- Windows might recognize device and function but not find drivers for it => "Unknown Device" or "Generic type" listed with yellow exclamation mark.
- If device never has worked: Check driver is compatible with OS => Download on manufacturers website or via Windows Update.
- In device manager, right click on device > Properties. Click on Update Driver.

### Removing, Uninstalling and Disabling devices
- Plug-n-Play devices can be removed without uninstalling
- Close apps that use a drive you are removing => Safely Remove Hardware icon in notification area => Stop or Eject device
- Optionally, right click and Uninstall Device (driver) before unplugging it
- Optionally Disable device, to not allow users to reach it if drivers not available or for security => Useful for devices that can't be easily removed

## Disk Management Console (diskmgmt.msc)
- Displays summary of fixed and removable disks. HDD and SSDs can be divided into logical partitions.

### Terminology
Partition: Configured on SSDs or HDDs, at least 1.
Volume: Logical unit available to the OS. It could be 1:1 mapping Partition-Volume, but a volume can be supported by multiple devices and partitions,like in RAID.
Drive: Volume that has been mapped to a letter

Disk 0 => Typically holds OS, and has 3 volumes:
    - System Volume: OS files, usually named `C:`
    - Boot volume: Files used to boot the OS with EFI (Extensible Firmware Interface) system. No letter usually
    - Recovery partition: Tools to repair damaged installation or reset to factory state. WinRE (Windows Recovery Environment). No letters.

### Supported tasks
1. Initializing Disk: For initializing unformatted HDD/SSDs. MBR or GPT partition styles as options.
2. Partitioning: Each disk needs at least one partition.
3. Formatting: New partitions need to have a file system, usually NTFS for Windows. FAT32 for smaller drives
    - 512-byte sector smallest unit of storage on fixed disks. File System can cluster sectors. Smaller sectors have better use of space, but larger sectors are more performant for larger file sizes.
    - You cannot delete system or boot partions. During setup, Boot partion must be NTFS and system patition in FAT32
4. Repartitioning: Existing partitions can be expanded, removed or shrunk.
5. Configuring Dynamic Disks: If more than one disk a dynamic disk can be configured to implement RAID redundancy => Now Storage Spaces.    

## Disk Maintenance tools
Disk drives and file systems require the most attention to keep PC performant

### Main problems of Disks
1. Fragmentation: When file is not saves on contiguous sectorof an HDD
2. Capacity. File creation > deletion. > 20% free space in boot volume and performance will be impared.
3. Damage: More commong in HDD, but also degradation in SSDs

### Tools to fix
1. Defragmentation (dfgui.exe)
- On HDD => rewrites files to keep them on contiguous clusters, reducing look up time
- On SSD => Data is stored on bloks not controlled by OS.
    - Defragmentation tool instructs the drive to run a TRIM process: Controller tags files marked by the OS as deletable and makes the writable.
    - It can perform a sort of defragmentation if Volume Shadow Copy service enabled

Windows automatically schedules disk optimization in the Task Scheduler.

2. Disk Clean-up (cleanmgr.exe)
- It tracks files that can be safely deleted to reclaim disk space (In Recycling bin)
- Can be run in admin mode to Clean Up System Files => Cleares cache from Windows Udpater and Windows Defender

## Task Scheduler (taskschd.msc)
Runs commands and scripts automatically

 - Trigger can be an event instead of a calendar date and time.
 - Tasks can include multiple actions
 - All activity logged
 - Tasks can be organized in folders
 - You must define the path to the task and the credetials the task will run under. Task won't run if user account doesn't have the proper permissions.

 ## Local Users and Groups Console (lusrmgr.msc)
 - Advanced UI to create, delete, disable, and modifying user accounts.
 - Security groups can be used to give common  permissions to users.

 ## Certificate Manager console (certmng.msc)
 - Digital certificate proves identity of subject, user, computer, service.
 - Validity of each certificate guaranteed by Certificate Authority (CA)
 - Certificate Manager console shows which certificates have been installed and mechanism to import and install new certificates.
 
### Main Subfolders of Certificate Manager
1. Personal => Certificates issues to the user's account for network auth, encryption, and digital signatures
2. Trusted Root Certificate Authority => Superset of certificates of all trusted issuers. Managed by Windows.
3. Third Party => Certificates from trusted issuers outside Microsoft and local enterprise.

- There's also computer certificate store (certlm.msc)
- Trusting an unsafe CA is a critical security vulnerability => A rougue certificate can allowa website to masquarade as a legitimate one.

## Group Policy Editor (gpedit.msc)
- Complex user and system registry configuration via policies
- Groups are more efficient way of managing policy settings with hundreds of users instead of manually configuring each machine.
- Policies enabled with toggle on a group level
- Local Security Policy Editor => Edits security policies specifically

## Registry Editor (regedit.exe)
The Registry is a remote accesible DB for OS, device, and software configuration storage

### Registry keys
In Registry Keys are equivalent to the Folders in the file system. Registry contains 5 keys with computer and user databases.
HKEY_LOCAL_MACHINE (HKLM) DB for system-wide settings
HKEY_USERS settings of individual user's profiles
HKEY_CURRENT_USER (HKCU): Subset of HKEY_USERS with settings for logged user

- Most work on Registry editor done on HKLM or HKCU
- Registry DB stored in binary files called `hives`: 1 file (no ext), .LOG file, .SAV (copy of the key at end of setup), .ALT backup file.

### Editing the Registry
- Each key can contain subkeys or `value entries`, analogous to folders
- Value keys are key pairs with three parts: name, data type, value.
- You can Export registry file to copy into another computer




